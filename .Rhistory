"X_Porcentaje_On_base_plus_slugging_t_1", "X_Porcentaje_On_base_plus_slugging_2_t_1",
"X_Porcentaje_on_base_t_1", "X_Porcentaje_on_base_2_t_1",
"X_Porcentaje_slugging_t_1", "X_Porcentaje_slugging_2_t_1",
"X_Runs_batted_in_t_1", "X_Runs_batted_in_2_t_1",
"X_Triples_t_1", "X_Triples_2_t_1",
"X_WAR_t_1", "X_WAR_2_t_1")
ya_hitter <- list('X_At_bats_t_1', 'X_Bateos_2_t_1',
'X_Bateos_promedio_t_1', 'X_Bateos_t_1',
'X_Dobles_2_t_1', 'X_Dobles_t_1',
'X_Home_runs_2_t_1', 'X_Home_runs_t_1',
'X_Juegos_iniciados_2_t_1', 'X_Juegos_iniciados_t_1',
'X_Porcentaje_On_base_plus_slugging_2_t_1',
'X_Porcentaje_On_base_plus_slugging_t_1',
'X_Porcentaje_on_base_2_t_1',
'X_Porcentaje_on_base_t_1',
'X_Porcentaje_slugging_2_t_1',
'X_Runs_batted_in_2_t_1',
'X_Triples_2_t_1', 'X_WAR_2_t_1', 'X_WAR_t_1')
# Agreguemos ambos sufijos
X_cum_hitter <- lapply(cum_hitter, function(x) paste(x, "_cum", sep = ""))
X_ya_hitter <- lapply(ya_hitter, function(x) paste(x, "_ya", sep = ""))
# remove the prefix 'X_' from the strings
ya_hitter <- sub("^X_", "", ya_hitter)
cum_hitter <- sub("^X_", "", cum_hitter)
# Lista con todas las variables
X_hitter_var_suf <- c(X_cum_hitter, X_ya_hitter)
hitter_var_suf <- sub("X_", "", X_hitter_var_suf)
# Constroles:
vars  <- 'Y_Sueldo_regular_norm_t ~ Edad_t + Anios_de_contrato_t'
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(base_vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- lm(formula,  data = hitter_data)
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# LIsta de variables acumuladas y anualmente promediadas_
cum_hitter <- list("X_At_bats_t_1", "X_At_bats_2_t_1",
"X_Bateos_t_1", "X_Bateos_2_t_1",
"X_Bateos_promedio_t_1", "X_Bateos_promedio_2_t_1",
"X_Dobles_t_1", "X_Dobles_2_t_1",
"X_Home_runs_t_1", "X_Home_runs_2_t_1",
"X_Juegos_iniciados_t_1", "X_Juegos_iniciados_2_t_1",
"X_Porcentaje_On_base_plus_slugging_t_1", "X_Porcentaje_On_base_plus_slugging_2_t_1",
"X_Porcentaje_on_base_t_1", "X_Porcentaje_on_base_2_t_1",
"X_Porcentaje_slugging_t_1", "X_Porcentaje_slugging_2_t_1",
"X_Runs_batted_in_t_1", "X_Runs_batted_in_2_t_1",
"X_Triples_t_1", "X_Triples_2_t_1",
"X_WAR_t_1", "X_WAR_2_t_1")
ya_hitter <- list('X_At_bats_t_1', 'X_Bateos_2_t_1',
'X_Bateos_promedio_t_1', 'X_Bateos_t_1',
'X_Dobles_2_t_1', 'X_Dobles_t_1',
'X_Home_runs_2_t_1', 'X_Home_runs_t_1',
'X_Juegos_iniciados_2_t_1', 'X_Juegos_iniciados_t_1',
'X_Porcentaje_On_base_plus_slugging_2_t_1',
'X_Porcentaje_On_base_plus_slugging_t_1',
'X_Porcentaje_on_base_2_t_1',
'X_Porcentaje_on_base_t_1',
'X_Porcentaje_slugging_2_t_1',
'X_Runs_batted_in_2_t_1',
'X_Triples_2_t_1', 'X_WAR_2_t_1', 'X_WAR_t_1')
# Agreguemos ambos sufijos
X_cum_hitter <- lapply(cum_hitter, function(x) paste(x, "_cum", sep = ""))
X_ya_hitter <- lapply(ya_hitter, function(x) paste(x, "_ya", sep = ""))
# remove the prefix 'X_' from the strings
ya_hitter <- sub("^X_", "", ya_hitter)
cum_hitter <- sub("^X_", "", cum_hitter)
# Lista con todas las variables
X_hitter_var_suf <- c(X_cum_hitter, X_ya_hitter)
hitter_var_suf <- c(ya_hitter, cum_hitter)
#hitter_var_suf <- sub("X_", "", X_hitter_var_suf)
# Constroles:
vars  <- 'Y_Sueldo_regular_norm_t ~ Edad_t + Anios_de_contrato_t'
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
#base_vars  <- paste(vars, hitter_var_suf[[i]],
#                    sep = '+')
formula <- paste(vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- lm(formula,  data = hitter_data)
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
X_hitter_var_suf
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- lm(formula,  data = hitter_data)
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(base_vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- lm(formula,  data = hitter_data)
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# LIsta de variables acumuladas y anualmente promediadas_
cum_hitter <- list("X_At_bats_t_1", "X_At_bats_2_t_1",
"X_Bateos_t_1", "X_Bateos_2_t_1",
"X_Bateos_promedio_t_1", "X_Bateos_promedio_2_t_1",
"X_Dobles_t_1", "X_Dobles_2_t_1",
"X_Home_runs_t_1", "X_Home_runs_2_t_1",
"X_Juegos_iniciados_t_1", "X_Juegos_iniciados_2_t_1",
"X_Porcentaje_On_base_plus_slugging_t_1", "X_Porcentaje_On_base_plus_slugging_2_t_1",
"X_Porcentaje_on_base_t_1", "X_Porcentaje_on_base_2_t_1",
"X_Porcentaje_slugging_t_1", "X_Porcentaje_slugging_2_t_1",
"X_Runs_batted_in_t_1", "X_Runs_batted_in_2_t_1",
"X_Triples_t_1", "X_Triples_2_t_1",
"X_WAR_t_1", "X_WAR_2_t_1")
ya_hitter <- list('X_At_bats_t_1', 'X_Bateos_2_t_1',
'X_Bateos_promedio_t_1', 'X_Bateos_t_1',
'X_Dobles_2_t_1', 'X_Dobles_t_1',
'X_Home_runs_2_t_1', 'X_Home_runs_t_1',
'X_Juegos_iniciados_2_t_1', 'X_Juegos_iniciados_t_1',
'X_Porcentaje_On_base_plus_slugging_2_t_1',
'X_Porcentaje_On_base_plus_slugging_t_1',
'X_Porcentaje_on_base_2_t_1',
'X_Porcentaje_on_base_t_1',
'X_Porcentaje_slugging_2_t_1',
'X_Runs_batted_in_2_t_1',
'X_Triples_2_t_1', 'X_WAR_2_t_1', 'X_WAR_t_1')
# Agreguemos ambos sufijos
X_cum_hitter <- lapply(cum_hitter, function(x) paste(x, "_cum", sep = ""))
X_ya_hitter <- lapply(ya_hitter, function(x) paste(x, "_ya", sep = ""))
# remove the prefix 'X_' from the strings
ya_hitter <- sub("^X_", "", ya_hitter)
cum_hitter <- sub("^X_", "", cum_hitter)
# Lista con todas las variables
X_hitter_var_suf <- c(X_cum_hitter, X_ya_hitter)
hitter_var_suf <- c(cum_hitter, ya_hitter)
#hitter_var_suf <- sub("X_", "", X_hitter_var_suf)
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(base_vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- lm(formula,  data = hitter_data)
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- lm(formula,  data = hitter_data)
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# LIsta de variables acumuladas y anualmente promediadas_
cum_fielder <- list('X_Bateos_2_t_1',
'X_Bateos_t_1',
'X_Carreras_2_t_1',
'X_Carreras_ganadas_2_t_1',
'X_Carreras_ganadas_t_1',
'X_Carreras_t_1',
'X_Comando_2_t_1',
'X_Comando_t_1',
'X_Control_2_t_1',
'X_Control_t_1',
'X_Dominio_2_t_1',
'X_Dominio_t_1',
'X_ERA_2_t_1',
'X_ERA_t_1',
'X_Inning_pitched_2_t_1',
'X_Inning_pitched_t_1',
'X_Losses_2_t_1',
'X_Losses_t_1',
'X_Saves_2_t_1',
'X_Saves_t_1',
'X_Strike_outs_2_t_1',
'X_Strike_outs_t_1',
'X_WAR_2_t_1',
'X_WAR_t_1',
'X_WHIP_2_t_1',
'X_WHIP_t_1',
'X_Walks_2_t_1',
'X_Walks_t_1',
'X_Wins_2_t_1',
'X_Wins_t_1')
ya_fielder <- list('X_Bateos_2_t_1',
'X_Bateos_t_1',
'X_Carreras_2_t_1',
'X_Carreras_ganadas_2_t_1',
'X_Carreras_ganadas_t_1',
'X_Carreras_t_1',
'X_Comando_2_t_1',
'X_Comando_t_1',
'X_Control_2_t_1',
'X_Control_t_1',
'X_Dominio_2_t_1',
'X_Dominio_t_1',
'X_ERA_2_t_1',
'X_ERA_t_1',
'X_Inning_pitched_2_t_1',
'X_Inning_pitched_t_1',
'X_Losses_2_t_1',
'X_Losses_t_1',
'X_Saves_2_t_1',
'X_Saves_t_1',
'X_Strike_outs_2_t_1',
'X_Strike_outs_t_1',
'X_WAR_2_t_1',
'X_WAR_t_1',
'X_WHIP_2_t_1',
'X_WHIP_t_1',
'X_Walks_2_t_1',
'X_Walks_t_1',
'X_Wins_2_t_1',
'X_Wins_t_1')
# Agreguemos ambos sufijos
X_cum_fielder <- lapply(cum_fielder, function(x) paste(x, "_cum", sep = ""))
X_ya_fielder <- lapply(ya_fielder, function(x) paste(x, "_ya", sep = ""))
# remove the prefix 'X_' from the strings
ya_fielder <- sub("^X_", "", ya_fielder)
cum_fielder <- sub("^X_", "", cum_fielder)
# Lista con todas las variables
X_fielder_var_suf <- c(X_cum_fielder, X_ya_fielder)
fielder_var_suf <- c(cum_fielder, ya_fielder)
#hitter_var_suf <- sub("X_", "", X_hitter_var_suf)
for (i in 1:length(X_fielder_var_suf)){
# run linear regression with grouped errors by country and robust errors
formula <- paste(base_vars,
X_fielder_var_suf[[i]],
sep = " + ")
s_m_pooled <- lm(formula,  data = starting_data)
my_lm_cluster <- coeftest(s_m_pooled,
vcov = vcovHC(s_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_fielder_var_suf)){
# run linear regression with grouped errors by country and robust errors
formula <- paste(base_vars,
X_fielder_var_suf[[i]],
sep = " + ")
s_m_pooled <- lm(formula,  data = starting_data)
my_lm_cluster <- coeftest(s_m_pooled,
vcov = vcovHC(s_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_fielder_var_suf)){
# run linear regression with grouped errors by country and robust errors
formula <- paste(vars,
X_fielder_var_suf[[i]],
sep = " + ")
r_m_pooled <- lm(formula,  data = starting_data)
my_lm_cluster <- coeftest(r_m_pooled,
vcov = vcovHC(r_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_fielder_var_suf)){
# run linear regression with grouped errors by country and robust errors
formula <- paste(vars,
X_fielder_var_suf[[i]],
sep = " + ")
s_m_pooled <- lm(formula,  data = starting_data)
my_lm_cluster <- coeftest(s_m_pooled,
vcov = vcovHC(s_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_fielder_var_suf)){
# run linear regression with grouped errors by country and robust errors
formula <- paste(vars,
X_fielder_var_suf[[i]],
sep = " + ")
r_m_pooled <- lm(formula,  data = relief_data)
my_lm_cluster <- coeftest(r_m_pooled,
vcov = vcovHC(r_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_fielder_var_suf)){
# run linear regression with grouped errors by country and robust errors
formula <- paste(vars,
X_fielder_var_suf[[i]],
sep = " + ")
r_m_pooled <- lm(formula,  data = relief_pitcher_data)
my_lm_cluster <- coeftest(r_m_pooled,
vcov = vcovHC(r_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_fielder_var_suf)){
# run linear regression with grouped errors by country and robust errors
formula <- paste(vars,
X_fielder_var_suf[[i]],
sep = " + ")
s_m_pooled <- lm(formula,  data = shorts_data)
my_lm_cluster <- coeftest(s_m_pooled,
vcov = vcovHC(s_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# Constroles:
vars  <- 'Y_Sueldo_regular_norm_t ~ Edad_t + Anios_de_contrato_t'
# loop over the variables in var_hitter_list
for (i in 1:length(X_fielder_var_suf)){
# run linear regression with grouped errors by country and robust errors
formula <- paste(vars,
X_fielder_var_suf[[i]],
sep = " + ")
s_m_pooled <- lm(formula,  data = shorts_data)
my_lm_cluster <- coeftest(s_m_pooled,
vcov = vcovHC(s_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars_d  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(vars,
X_hitter_var_suf[[i]],
sep = " + ")
d_m_pooled <- lm(formula,  data = d_hitter_data)
my_lm_cluster <- coeftest(d_m_pooled,
vcov = vcovHC(d_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars_h  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- plm(formula, data = hitter_data,
model = "pooling",
index = c("Jugador", "Anio_t"))
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
setwd("~/Documentos/Github/Proyectos/MLB_HN/")
hitters_panel <- read.csv('ETL_Data/Panel/General/Dynamic_model/dynamic_model_hitter.csv')
fielders_panel <- read.csv('ETL_Data/Panel/General/Dynamic_model/dynamic_model_fielder.csv')
# filter out rows with year 2020
# Bateadores
hitters_panel_covid <- hitters_panel %>%
filter(Anio_t != 2020)
# Fildeadores
fielders_panel_covid <- fielders_panel %>%
filter(Anio_t != 2020)
# split the data frame by category
split_hitter <- split(hitters_panel,
f = hitters_panel$Posicion_t)
split_fielder <- split(fielders_panel,
f = fielders_panel$Posicion_t)
# COVID panels:
split_hitter_covid <- split(hitters_panel_covid,
f = hitters_panel_covid$Posicion_t)
split_fielder_covid <- split(fielders_panel_covid,
f = fielders_panel_covid$Posicion_t)
# Whole panel:
# Offensive:
h_category_1 <- split_hitter[["SP"]]
h_category_2 <- split_hitter[["RP"]]
h_category_3 <- split_hitter[["RP/CL"]]
h_category_4 <- split_hitter[["C"]]
h_category_5 <- split_hitter[["1B"]]
h_category_6 <- split_hitter[["2B"]]
h_category_7 <- split_hitter[["3B"]]
h_category_8 <- split_hitter[["SS"]]
h_category_9 <- split_hitter[["RF"]]
h_category_10 <- split_hitter[["CF"]]
h_category_11 <- split_hitter[["LF"]]
d_hitter_data <- split_hitter[["DH"]]
# Defensive:
starting_data <- split_fielder[["SP"]]
b_category_2 <- split_fielder[["RP"]]
b_category_3 <- split_fielder[["RP/CL"]]
shorts_data <- split_fielder[["SS"]]
# COVID panel:
# Offensive:
cov_h_category_1 <- split_hitter_covid[["SP"]]
cov_h_category_2 <- split_hitter_covid[["RP"]]
cov_h_category_3 <- split_hitter_covid[["RP/CL"]]
cov_h_category_4 <- split_hitter_covid[["C"]]
cov_h_category_5 <- split_hitter_covid[["1B"]]
cov_h_category_6 <- split_hitter_covid[["2B"]]
cov_h_category_7 <- split_hitter_covid[["3B"]]
cov_h_category_8 <- split_hitter_covid[["SS"]]
cov_h_category_9 <- split_hitter_covid[["RF"]]
cov_h_category_10 <- split_hitter_covid[["CF"]]
cov_h_category_11 <- split_hitter_covid[["LF"]]
d_hitter_cov_data <- split_hitter_covid[["DH"]]
# Defensive:
starting_cov_data <- split_fielder_covid[["SP"]]
cov_b_category_2 <- split_fielder_covid[["RP"]]
cov_b_category_3 <- split_fielder_covid[["RP/CL"]]
shorts_cov_data <- split_fielder_covid[["SS"]]
# All panels:
# Hitters:
# Concatenate the two categories
hitter_data <- rbind(h_category_1, h_category_2, h_category_3, h_category_4,
h_category_5, h_category_6, h_category_7, h_category_8,
h_category_9, h_category_10, h_category_11)
hitter_data <- unique(hitter_data)
# Fielders:
# Concatenate the two categories
relief_pitcher_data <- rbind(b_category_2, b_category_3)
relief_pitcher_data <- unique(relief_pitcher_data)
# COVID filter:
# Hitters:
# Concatenate the two categories
hitter_cov_data <- rbind(cov_h_category_1, cov_h_category_2, cov_h_category_3, cov_h_category_4,
cov_h_category_5, cov_h_category_6, cov_h_category_7, cov_h_category_8,
cov_h_category_9, cov_h_category_10, cov_h_category_11)
hitter_cov_data <- unique(hitter_cov_data)
# Fielders:
# Concatenate the two categories
relief_pitcher_cov_data <- rbind(cov_b_category_2, cov_b_category_3)
relief_pitcher_cov_data <- unique(relief_pitcher_cov_data)
print("Regular hitter: ")
print(dim(hitter_cov_data))
print("")
print("Designated hitter: ")
print(dim(d_hitter_cov_data))
print("")
print("Relief pitchers: ")
print(dim(relief_pitcher_cov_data))
print("")
print("Starting pitchers: ")
print(dim(starting_cov_data))
print("")
print("Short stops: ")
print(dim(shorts_cov_data))
hitters_panel %>% count(Posicion_t, sort = TRUE)
fielders_panel %>% count(Posicion_t, sort = TRUE)
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars_h  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- plm(formula, data = hitter_data,
model = "pooling",
index = c("Jugador", "Anio_t"))
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "Jugador"))
print(my_lm_cluster)
}
# loop over the variables in var_hitter_list
for (i in 1:length(X_hitter_var_suf)){
# run linear regression with grouped errors by country and robust errors
base_vars_h  <- paste(vars, hitter_var_suf[[i]],
sep = '+')
formula <- paste(vars,
X_hitter_var_suf[[i]],
sep = " + ")
h_m_pooled <- plm(formula, data = hitter_data,
model = "pooling",
index = c("Jugador", "Anio_t"))
my_lm_cluster <- coeftest(h_m_pooled,
vcov = vcovHC(h_m_pooled,
cluster = "group"))
print(my_lm_cluster)
}
