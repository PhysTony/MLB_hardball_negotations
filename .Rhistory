remove_selected_columns = TRUE)
head(dummy)
colnames(free_agents)
colnames(dummy)
summary(iv_model, diagnostics=TRUE)
formula_iv <- Y ~ X | Equipos_estado + Posicion_1B + Posicion_2B + Posicion_3B + Posicion_C + Posicion_CF + Posicion_DH + Posicion_LF + Posicion_RF + Posicion_RP + Posicion_RP/CL +  Posicion_SP + Posicion_SS + Equipo_ARI + Equipo_ATL + Equipo_BAL + Equipo_BOS + Equipo_CHC + Equipo_CHW + Equipo_CIN +  Equipo_COL + Equipo_DET + Equipo_HOU +  Equipo_KC  +  Equipo_LAA +  Equipo_LAD +  Equipo_MIA + Equipo_MIL + Equipo_MIN +  Equipo_NYM +  Equipo_NYY +   Equipo_OAK + Equipo_PHI + Equipo_PIT +   Equipo_SD  +  Equipo_SEA +  Equipo_SF  +  Equipo_STL + Equipo_TB  +  Equipo_TEX + Equipo_TOR + Equipo_WSH
iv_model <- ivreg(formula_iv, data = dummy)
names(dummy)[names(dummy) == 'Posicion_RP/CL'] <- 'Posicion_RP_CL'
formula_iv <- Y ~ X | Equipos_estado + Posicion_1B + Posicion_2B + Posicion_3B + Posicion_C + Posicion_CF + Posicion_DH + Posicion_LF + Posicion_RF + Posicion_RP + Posicion_RP_CL +  Posicion_SP + Posicion_SS + Equipo_ARI + Equipo_ATL + Equipo_BAL + Equipo_BOS + Equipo_CHC + Equipo_CHW + Equipo_CIN +  Equipo_COL + Equipo_DET + Equipo_HOU +  Equipo_KC  +  Equipo_LAA +  Equipo_LAD +  Equipo_MIA + Equipo_MIL + Equipo_MIN +  Equipo_NYM +  Equipo_NYY +   Equipo_OAK + Equipo_PHI + Equipo_PIT +   Equipo_SD  +  Equipo_SEA +  Equipo_SF  +  Equipo_STL + Equipo_TB  +  Equipo_TEX + Equipo_TOR + Equipo_WSH
iv_model <- ivreg(formula_iv, data = dummy)
summary(iv_model, diagnostics=TRUE)
library(tidyverse)
library(dplyr)
library(sandwich)
library(stargazer)
library(ggplot2)
knitr::opts_chunk$set(collapse = TRUE, fig.pos = "H")
getwd()
setwd("/home/usuario/Documentos/Github/Proyectos/MLB_HN")
getwd()
setwd("/home/usuario/Documentos/Github/Proyectos/MLB_HN")
# Auxiliares
csv = ".csv"
# Directorios
hitters_path = "ETL_Data/Agent/First_Year_Contract/Period_t/Free_Agent/Hitters/panel_hitters"
pitchers_path = "ETL_Data/Agent/First_Year_Contract/Period_t/Free_Agent/Pitchers/panel_pitchers"
# Bases de datos:
panel_hitter = read_csv(hitters_path + csv)
setwd("/home/usuario/Documentos/Github/Proyectos/MLB_HN")
# Auxiliares
csv = ".csv"
# Directorios
hitters_path = "ETL_Data/Agent/First_Year_Contract/Period_t/Free_Agent/Hitters/panel_hitters"
pitchers_path = "ETL_Data/Agent/First_Year_Contract/Period_t/Free_Agent/Pitchers/panel_pitchers"
# Bases de datos:
panel_hitter = read_csv(paste(hitters_path, csv, sep=""))
panel_pitcher = read_csv(paste(pitchers_path, csv, sep=""))
Observemos una breve descripciÃ³n de las columnas que contiene cada base de datos
# Hitters
str(panel_hitter)
# Hitters
print("Hitters:")
str(panel_hitter)
# Hitters
print("Hitters:")
str(panel_hitter)
print(" \n \n")
# Hitters
print("Hitters:")
str(panel_hitter)
print("\n \n")
print("Pitchers:")
str(panel_pitcher)
# Hitters
###############################################################################
############################ Hitters ##########################################
###############################################################################
str(panel_hitter)
###############################################################################
############################ Pitchers #########################################
###############################################################################
str(panel_pitcher)
hitter_statistics <- list('At-bats', 'Bateos_promedio', 'Dobles',
'Home-runs', 'Porcentaje_On-base-plus-slugging',
'Porcentaje_juegos', 'Porcentaje_juegos_iniciados',
'Porcentaje_on-base', 'Porcentaje_slugging', 'Runs-batted-in',
'Triples', 'WAR')
pitcher_statistics <- list('Bateos_en_contra', 'Carreras_en_contra', 'Carreras_ganadas',
'Comando', 'Control', 'Dominio', 'ERA', 'Inning_pitched',
'Porcentaje_juegos', 'Juegos_iniciados', 'Losses', 'Saves',
'Strike-outs', 'WAR', 'WHIP', 'Walks', 'Wins')
# Change line colors by groups
ggplot(panel_hitter, aes(x=Dobles, color=Agente_libre, fill=Agente_libre)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+
geom_density(alpha=0.6)+
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
labs(title="Weight histogram plot",x="Weight(kg)", y = "Density")+
theme_classic()
# Change line colors by groups
ggplot(panel_hitter, aes(x=hitter_statistics[1], color=Agente_libre, fill=Agente_libre)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+
geom_density(alpha=0.6)+
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
labs(title="Weight histogram plot",x="Weight(kg)", y = "Density")+
theme_classic()
hitter_statistics[1]
# Change line colors by groups
ggplot(panel_hitter, aes(x=Home-runs, color=Agente_libre, fill=Agente_libre)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+
geom_density(alpha=0.6)+
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
labs(title="Weight histogram plot",x="Weight(kg)", y = "Density")+
theme_classic()
# Change line colors by groups
ggplot(panel_hitter, aes(x=WAR, color=Agente_libre, fill=Agente_libre)) +
geom_histogram(aes(y=..density..), position="identity", alpha=0.5)+
geom_density(alpha=0.6)+
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
labs(title="Weight histogram plot",x="Weight(kg)", y = "Density")+
theme_classic()
panel_hitter %>%
ggplot(aes(x=Dobles)) +
geom_histogram(aes(y=..density..),
bins=20,
fill="#69b3a2",
color="#e9ecef",
alpha=0.9) +
geom_density(kernel="epanechnikov",
bw=10,
linetype="solid")+
theme(plot.title = element_text(size=15))
panel_hitter %>%
ggplot(aes(x=Dobles,
color=Agente_libre,
fill=Agente_libre)) +
geom_histogram(aes(y=..density..),
bins=20,
fill="#69b3a2",
color="#e9ecef",
alpha=0.9) +
geom_density(kernel="epanechnikov",
bw=10,
linetype="solid")+
theme(plot.title = element_text(size=15))
# Change line colors by groups
ggplot(panel_hitter, aes(x=WAR, color=Agente_libre,
fill=Agente_libre)) +
geom_histogram(aes(y = ..density..), position="identity",
alpha=0.5) +
geom_density(alpha=0.6,
bw = 3) +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
labs(title="Weight histogram plot",x="Weight(kg)", y = "Density")+
theme_classic()
# Change line colors by groups
ggplot(panel_hitter, aes(x=WAR, color=Agente_libre,
fill=Agente_libre)) +
geom_histogram(aes(y = ..density..),
bins = 10,
position="identity",
alpha=0.5) +
geom_density(alpha=0.6,
bw = 3) +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))+
labs(title="Weight histogram plot",x="Weight(kg)", y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x=WAR, color=Agente_libre,
fill=Agente_libre)) +
geom_histogram(aes(y = ..density..),
bins = 10,
position = "identity",
alpha=0.5) +
geom_density(kernel="epanechnikov",
alpha=0.6,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values=c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x=WAR, color=Agente_libre,
fill=Agente_libre)) +
geom_histogram(aes(y = ..density..),
bins = 20,
position = "identity",
alpha=0.5) +
geom_density(kernel="epanechnikov",
alpha=0.6,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values=c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = WAR,
color = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 20,
position = "identity",
alpha = 0.5) +
geom_density(kernel="epanechnikov",
alpha=0.6,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values=c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values=c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = WAR,
color = Agente_libre,
fill = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 20,
position = "identity",
alpha = 0.5) +
geom_density(kernel = "epanechnikov",
alpha = 0.6,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = WAR,
color = Agente_libre,
fill = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 20,
position = "identity",
alpha = 0.5) +
geom_density(kernel = "epanechnikov",
alpha = 0.2,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = WAR,
color = Agente_libre,
fill = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 20,
position = "identity",
alpha = 0.5) +
geom_density(kernel = "epanechnikov",
alpha = 0.01,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = WAR,
color = Agente_libre,
fill = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 20,
position = "identity",
alpha = 0.5) +
geom_density(kernel = "epanechnikov",
alpha = 0.9,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = WAR,
color = Agente_libre,
fill = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 20,
position = "identity",
alpha = 0.7) +
geom_density(kernel = "epanechnikov",
alpha = 0.1,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$WAR)
w.iqr.adj <- IQR(panel_hitter$WAR)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = WAR,
color = Agente_libre,
fill = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 20,
position = "identity",
alpha = 0.7) +
geom_density(kernel = "epanechnikov",
alpha = 0.1,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values = c("#000000",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$Porcentaje_slugging)
w.iqr.adj <- IQR(panel_hitter$Porcentaje_slugging)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = Porcentaje_slugging,
color = Agente_libre,
fill = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 20,
position = "identity",
alpha = 0.7) +
geom_density(kernel = "epanechnikov",
alpha = 0.1,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
delta <- 1.7188 # Ver CT
w.sd <- sd(panel_hitter$Porcentaje_slugging)
w.iqr.adj <- IQR(panel_hitter$Porcentaje_slugging)/1.349
w.N <- nrow(panel_hitter)
constante <- 1.3643
ajuste <- min(w.sd,w.iqr.adj)
h <- constante*delta*ajuste*w.N^(-0.2) # ancho de banda
# Change line colors by groups
ggplot(panel_hitter, aes(x = Porcentaje_slugging,
color = Agente_libre,
fill = Agente_libre)) +
geom_histogram(aes(y = ..density..) ,
bins = 10,
position = "identity",
alpha = 0.7) +
geom_density(kernel = "epanechnikov",
alpha = 0.1,
bw = h/2,
linetype = "solid") +
#geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
#           linetype="dashed")+
scale_color_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
scale_fill_manual(values = c("#999999",
"#E69F00",
"#56B4E9"))+
labs(title="Weight histogram plot",
x = "Weight(kg)",
y = "Density")+
theme_classic()
v <- ggplot(data=panel_hitter , aes(x=WAR))
v + geom_histogram(binwidth=10 , aes(fill=Agente_libre) ,
color="Black")
# Facetas:
v + geom_histogram(binwidth=10 , aes(fill=Agente_libre) ,
color="Black") +
facet_grid(Agente_libre~.)
v + geom_histogram(binwidth=10 , aes(fill=Agente_libre) ,
color="Black") +
facet_grid(Agente_libre~. , scale="free")
